using System;
using System.Linq;
using Common;
using static Common.Utils;

namespace Day01
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            PrintHeader("Day 01");

            const string input = "818275977931166178424892653779931342156567268946" +
                                 "849597948944469863818248114327524824136924486891" +
                                 "794739281668741616818614613222585132742386168687" +
                                 "517939432911753846817997473555693821316918473474" +
                                 "459788714917665794336753628836231159578734813485" +
                                 "687247273288926216976992516314415836985611354682" +
                                 "821892793983922755395577592859959966574329787693" +
                                 "934242233159947846757279523939217844194346599494" +
                                 "858459582798326799512571365294673978955928416955" +
                                 "127211624234143497546729348687844317864243859238" +
                                 "665326784414349618985832259224761857371389133635" +
                                 "711819476969854584123589566163491796442167815899" +
                                 "539788237118339218699137497532932492226948892362" +
                                 "554937381497389469981346971998271644362944839883" +
                                 "953967698665427314592438958181697639594631142991" +
                                 "156327257413186621923369632466918836951277519421" +
                                 "695264986942261781256412377711245825379412978876" +
                                 "134267384793694756732246799739464721215446477972" +
                                 "737883445615664755923441441781128933369585655925" +
                                 "615257548499628878242122434979197969569971961379" +
                                 "367756499884537433839217835728263798431874654317" +
                                 "137955175565253555735968376115749641527957935691" +
                                 "487965161211853476747758982854811367422656321836" +
                                 "839326818976668191525884763294465366151349347633" +
                                 "968321457954152621175837754723675485348339261288" +
                                 "195865348545793575843874731785852718281311481217" +
                                 "515834822185477982342271937155479432673815629144" +
                                 "664144538221768992733498856934255518875381672342" +
                                 "521819499939835919827166318715849161715775427981" +
                                 "485233467222586764392783699273452228728667175488" +
                                 "552924399518855743923659815483988899924199449721" +
                                 "321589476864161778841352853573584489497263216627" +
                                 "369841455165476954483715112127465311353411346132" +
                                 "671561568444626828453687183385215975319858714144" +
                                 "975174516356117245993696521941589168394574287785" +
                                 "233685284294357548156487538175462176268162852746" +
                                 "996633977948755296869616778577327951858348313582" +
                                 "783675149343562362974553976147259225311183729415" +
                                 "381527435926224781181987111454447371894645359797" +
                                 "229493458443522549386769845742557644349554641538" +
                                 "488252581267341635761715674381775778868374988451" +
                                 "463624332123361576518411234438681171864923916896" +
                                 "987836734129295354684962897616358722633724198278" +
                                 "552339794629939574841672355699222747886785616814" +
                                 "449297817352118452284785694551841431869545321438" +
                                 "468118";

            var result1 = CalculateAnswer1(input);
            var result2 = CalculateAnswer2(input);

            PrintAnswer("Problem 1 answer", result1);
            PrintAnswer("Problem 2 answer", result2);
        }

        private static int CalculateAnswer1(string input)
        {
            if (string.IsNullOrEmpty(input))
                return 0;

            var augmentedInput = input + input[0];

            return augmentedInput
                .Select(@char => @char - '0')
                .SlidingWindow(2)
                .Select(window => window.ToArray())
                .Where(window => window[0] == window[1])
                .Sum(ints => ints[0]);
        }

        private static int CalculateAnswer2(string input)
        {
            if (string.IsNullOrEmpty(input))
                return 0;

            var ints = input.Select(@char => @char - '0').ToArray();
            var length = ints.Length;

            var shift = ints.Length / 2;

            return Enumerable.Range(0, length)
                .Select(i => (ints[i], ints[(i + shift) % length]))
                .Where(a => a.Item1 == a.Item2)
                .Sum(a => a.Item1);
        }
    }
}
